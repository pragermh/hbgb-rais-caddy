services:
  rais:
    image: uolibraries/rais:latest
    container_name: rais
    restart: unless-stopped
    env_file:
      - .env
    environment:
      - RAIS_ADDRESS=:12415
      - RAIS_IIIFURL=http://${HOST}:8080/iiif
      - RAIS_TILEPATH=/var/local/images
      - RAIS_TILECACHELEN=10000
    volumes:
      - ${DATA_PATH}data/Delivery:/var/local/images:ro,Z
    expose:
      - "12415"

  caddy:
    image: caddy:2-alpine
    container_name: caddy
    restart: unless-stopped
    depends_on:
      - rais
    ports:
      - "8080:8080"
    volumes:
      - ./Caddyfile:/etc/caddy/Caddyfile:ro,Z
      - ./webroot:/srv/www:ro,Z
